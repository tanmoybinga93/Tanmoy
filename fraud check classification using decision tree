library(caret)
library(tree)
library(C50)
library(party)
library(rpart)
library(gmodels)
install.packages("knitr")
library(knitr)
install.packages("png")
library(png)
fraud_data<- read.csv(file.choose())
View(fraud_data)
str(fraud_data)
attach(fraud_data)
mean(fraud_data$Taxable.Income)
mean(fraud_data$City.Population)
mean(fraud_data$Work.Experience)
hist(fraud_data$Taxable.Income)
hist(fraud_data$City.Population)
hist(fraud_data$Work.Experience)
head(fraud_data)
#spliting the data into training and testing based on sales. 
risk_good_model<- ifelse(fraud_data$Taxable.Income>= 30000,"risky","good")
model1<- data.frame(fraud_data,risk_good_model)
cd<- model1[,1:6]
View(cd)
model1_train<- model1[1:300,]
View(model1_train)
model1_test<- model1[301:600,]
View(model1_test)
#using party function 
png(file = "decision_tree.png")
marital_status<- as.factor(model1$Marital.Status)
under_grad<- as.factor(model1$Undergrad)
urban_fact<- as.factor(model1$Urban)
risk_good_model_fact<- as.factor(model1$risk_good_model)
desc_tree<- ctree(risk_good_model_fact~ under_grad + marital_status + City.Population + Work.Experience + urban_fact, data= model1)
summary(desc_tree)
png(file = "decision_tree.png")
marital_status_train<- as.factor(model1_train$Marital.Status)
under_grad_train<- as.factor(model1_train$Undergrad)
Urban_train<- as.factor(model1_train$Urban)
risk_good_model_train<- as.factor(model1_train$risk_good_model)
desc_tree1<- ctree(risk_good_model_train ~ under_grad_train + marital_status_train + City.Population + Work.Experience + Urban_train, data= model1_train)
summary(desc_tree1)
plot(desc_tree1)
marital_status_test<- as.factor(model1_test$Marital.Status)
under_grad_test<- as.factor(model1_test$Undergrad)
Urban_test<- as.factor(model1_test$Urban)
risk_good_model_test<- as.factor(model1_test$risk_good_model)
desc_tree2<- ctree(risk_good_model_test ~ under_grad_test + marital_status_test + City.Population + Work.Experience + Urban_test, data = model1_test)
summary(desc_tree2)
plot(desc_tree2)
pred_tree<- as.data.frame(predict(desc_tree1, newdata = model1_test))
pred_tree["final"]<- NULL
pred_test_df<- predict(desc_tree1, newdata = model1_test)
mean(pred_test_df==model1_test$risk_good_model) # 0.82
CrossTable(model1_test$risk_good_model,pred_test_df) # good- 54, risk- 246
last1<- as.factor(model1_test$risk_good_model)
confusionMatrix(last1,pred_test_df) # accuracy= 0.82 with 95% CI: (0.7718 , 0.8618), sensitivity = 0.82 , specificity = NA, 
